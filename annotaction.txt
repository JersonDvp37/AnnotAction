<li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Plan
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Outro Título</h4>
                        <p className={notesCss['note-description']}>
                            Outra descrição de exemplo. Esta é uma nota importante.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        22/07/2025 - 15:45
                    </div>
                </li>

                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Work
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Título da Nota</h4>
                        <p className={notesCss['note-description']}>
                            Descrição da nota, com algumas palavras de exemplo para preencher o espaço.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        23/07/2025 - 10:30
                    </div>
                </li>

                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Plan
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Outro Título</h4>
                        <p className={notesCss['note-description']}>
                            Outra descrição de exemplo. Esta é uma nota importante.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        22/07/2025 - 15:45
                    </div>
                </li>
                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Work
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Título da Nota</h4>
                        <p className={notesCss['note-description']}>
                            Descrição da nota, com algumas palavras de exemplo para preencher o espaço.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        23/07/2025 - 10:30
                    </div>
                </li>

                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Plan
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Outro Título</h4>
                        <p className={notesCss['note-description']}>
                            Outra descrição de exemplo. Esta é uma nota importante.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        22/07/2025 - 15:45
                    </div>
                </li>
                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Work
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Título da Nota</h4>
                        <p className={notesCss['note-description']}>
                            Descrição da nota, com algumas palavras de exemplo para preencher o espaço.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        23/07/2025 - 10:30
                    </div>
                </li>

                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Plan
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Outro Título</h4>
                        <p className={notesCss['note-description']}>
                            Outra descrição de exemplo. Esta é uma nota importante.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        22/07/2025 - 15:45
                    </div>
                </li>
                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Work
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Título da Nota</h4>
                        <p className={notesCss['note-description']}>
                            Descrição da nota, com algumas palavras de exemplo para preencher o espaço.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        23/07/2025 - 10:30
                    </div>
                </li>

                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Plan
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Outro Título</h4>
                        <p className={notesCss['note-description']}>
                            Outra descrição de exemplo. Esta é uma nota importante.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        22/07/2025 - 15:45
                    </div>
                </li>
                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Work
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Título da Nota</h4>
                        <p className={notesCss['note-description']}>
                            Descrição da nota, com algumas palavras de exemplo para preencher o espaço.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        23/07/2025 - 10:30
                    </div>
                </li>

                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Plan
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Outro Título</h4>
                        <p className={notesCss['note-description']}>
                            Outra descrição de exemplo. Esta é uma nota importante.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        22/07/2025 - 15:45
                    </div>
                </li>
                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Work
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Título da Nota</h4>
                        <p className={notesCss['note-description']}>
                            Descrição da nota, com algumas palavras de exemplo para preencher o espaço.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        23/07/2025 - 10:30
                    </div>
                </li>

                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Plan
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Outro Título</h4>
                        <p className={notesCss['note-description']}>
                            Outra descrição de exemplo. Esta é uma nota importante.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        22/07/2025 - 15:45
                    </div>
                </li>
                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Work
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Título da Nota</h4>
                        <p className={notesCss['note-description']}>
                            Descrição da nota, com algumas palavras de exemplo para preencher o espaço.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        23/07/2025 - 10:30
                    </div>
                </li>

                <li className={notesCss['li-mynotes-item']}>
                    <div className={notesCss['note-category']}>
                        Plan
                    </div>
                    <div className={notesCss['note-content']}>
                        <h4 className={notesCss['note-title']}>Outro Título</h4>
                        <p className={notesCss['note-description']}>
                            Outra descrição de exemplo. Esta é uma nota importante.
                        </p>
                    </div>
                    <div className={notesCss['note-date']}>
                        22/07/2025 - 15:45
                    </div>
                </li>  




"use client";

import { useRef, useImperativeHandle, forwardRef } from "react";
import styles from "./TextEditor.module.css";

const TextEditor = forwardRef(function TextEditor({ onChange }, ref) {
  const editorRef = useRef(null);
  const savedSelection = useRef(null);
  const activeColor = useRef(null); // Cor ativa para texto

  // =========================================================
  // SALVAR E RESTAURAR SELEÇÃO
  // =========================================================
  const saveSelection = () => {
    const sel = window.getSelection();
    if (sel && sel.rangeCount > 0) {
      savedSelection.current = sel.getRangeAt(0);
    }
  };

  const restoreSelection = () => {
    const sel = window.getSelection();
    if (savedSelection.current && sel) {
      sel.removeAllRanges();
      sel.addRange(savedSelection.current);
    }
  };

  // =========================================================
  // APLICAR COR NO TEXTO
  // =========================================================
  const applyColor = (color) => {
    activeColor.current = color; // Salva a cor ativa
    const selection = window.getSelection();
    if (!selection) return;

    if (selection.rangeCount > 0 && !selection.isCollapsed) {
      // Aplica a cor ao texto selecionado
      restoreSelection();
      document.execCommand("styleWithCSS", false, true);
      document.execCommand("foreColor", false, color);
    } else {
      // Define a cor para o próximo texto digitado
      editorRef.current.focus();
    }
  };

  // =========================================================
  // MANTER A COR ATIVA ENQUANTO DIGITA
  // =========================================================
  const handleInput = () => {
    if (!editorRef.current) return;

    if (activeColor.current) {
      document.execCommand("styleWithCSS", false, true);
      document.execCommand("foreColor", false, activeColor.current);
    }

    if (onChange) onChange(editorRef.current.innerHTML || "");
  };

  useImperativeHandle(ref, () => ({
    applyColor,
    saveSelection,
    restoreSelection,
    getContent: () => editorRef.current?.innerHTML || "",
    clearContent: () => {
      if (editorRef.current) editorRef.current.innerHTML = "";
    },
  }));

  // =========================================================
  // RENDER
  // =========================================================
  return (
    <div className={styles.editorContainer}>
      <div
        ref={editorRef}
        className={styles.editor}
        contentEditable
        suppressContentEditableWarning={true}
        onInput={handleInput}
        onMouseUp={saveSelection}
        onKeyUp={saveSelection}
        data-placeholder="Comece a escrever sua nota aqui..."
      />
    </div>
  );
});

export default TextEditor;
